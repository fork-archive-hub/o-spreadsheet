<templates>
  <t t-name="o-spreadsheet-SpreadsheetDashboard" owl="1">
    <div class="o-grid o-two-columns" tabindex="-1" t-on-wheel="onMouseWheel" t-ref="grid">
      <GridOverlay
        onCellClicked.bind="onCellClicked"
        onCellRightClicked.bind="onCellRightClicked"
        onCellHovered.bind="onCellHovered"
        onGridResized.bind="onGridResized"
        gridOverlayDimensions="gridOverlayDimensions"
      />
      <canvas t-ref="canvas"/>
      <Popover
        t-if="cellPopover.isOpen"
        position="cellPopover.coordinates"
        childWidth="cellPopover.Component.size.width"
        childHeight="cellPopover.Component.size.height"
        flipHorizontalOffset="cellPopover.cellWidth"
        flipVerticalOffset="cellPopover.cellHeight"
        onMouseWheel="onMouseWheel.bind(this)">
        <t
          t-component="cellPopover.Component"
          t-props="{...cellPopover.props, onClosed : () => onClosePopover()}"
        />
      </Popover>
      <Menu
        t-if="menuState.isOpen"
        menuItems="menuState.menuItems"
        position="menuState.position"
        onClose="() => this.closeMenu()"
      />
      <t t-set="gridSize" t-value="env.model.getters.getMainViewportRect()"/>
      <div
        class="o-scrollbar vertical"
        t-on-scroll="onScroll"
        t-ref="vscrollbar"
        t-att-style="vScrollbarStyle">
        <div t-attf-style="width:1px;height:{{gridSize.height}}px"/>
      </div>
      <div
        class="o-scrollbar horizontal"
        t-on-scroll="onScroll"
        t-ref="hscrollbar"
        t-att-style="hScrollbarStyle">
        <div t-attf-style="height:1px;width:{{gridSize.width}}px"/>
      </div>
      <div class="o-scrollbar corner"/>
    </div>
  </t>
</templates>
