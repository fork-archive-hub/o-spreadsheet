<templates>
  <t t-name="o-spreadsheet-SelectionInput" owl="1">
    <div class="o-selection">
      <div
        t-foreach="ranges"
        t-as="range"
        t-key="range.id"
        class="o-selection-input d-flex py-1"
        t-att-class="props.class">
        <input
          type="text"
          spellcheck="false"
          t-on-change="(ev) => this.onInputChanged(range.id, ev)"
          t-on-focus="() => this.focus(range.id)"
          t-att-value="range.xc"
          t-att-style="getColor(range)"
          class="flex-grow-1"
          t-att-class="{
            'o-focused border-primary' : range.isFocused,
            'o-required': props.required,
            'o-optional': !props.required,
            'o-invalid': isInvalid || !range.isValidRange,
          }"
        />
        <button
          class="o-btn o-remove-selection flex-shrink-1 btn btn-link pb-0 text-dark text-decoration-none lh-1"
          t-if="ranges.length > 1"
          t-on-click="() => this.removeInput(range.id)">
          âœ–
        </button>
      </div>

      <div class="o-selection-input">
        <button
          class="o-btn-action o-add-selection btn btn-link"
          t-if="canAddRange"
          t-on-click="addEmptyInput">
          Add range
        </button>
        <button
          class="o-btn-action o-selection-ok btn btn-link"
          t-if="hasFocus"
          t-on-click="disable">
          Confirm
        </button>
      </div>
    </div>
  </t>
</templates>
